!function t(e,n,r){function a(i,o){if(!n[i]){if(!e[i]){var h="function"==typeof require&&require;if(!o&&h)return h(i,!0);if(s)return s(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[i]={exports:{}};e[i][0].call(c.exports,function(t){var n=e[i][1][t];return a(n?n:t)},c,c.exports,t,e,n,r)}return n[i].exports}for(var s="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(t,e,n){!function(){this.apglib=t("./export.js")}()},{"./export.js":4}],2:[function(t,e,n){e.exports=function(){"use strict";function e(t){for(var e="",n=0;t>n;n+=1)e+=" ";return e}var n="ast.js: ",r=t("./identifiers.js"),a=t("./utilities.js"),s=this,i=null,o=null,h=null,l=0,c=[],p=[],u=[],f=[];this.callbacks=[],this.astObject="astObject",this.init=function(t,e,r){u.length=0,f.length=0,c.length=0,l=0,i=t,o=e,h=r;var a,d=[];for(a=0;a<i.length;a+=1)d.push(i[a].lower);for(a=0;a<o.length;a+=1)d.push(o[a].lower);for(l=i.length+o.length,a=0;l>a;a+=1)c[a]=!1,p[a]=null;for(var T in s.callbacks){var A=T.toLowerCase();if(a=d.indexOf(A),0>a)throw new Error(n+"init: node '"+T+"' not a rule or udt name");"function"==typeof s.callbacks[T]&&(c[a]=!0,p[a]=s.callbacks[T]),s.callbacks[T]===!0&&(c[a]=!0)}},this.ruleDefined=function(t){return c[t]!==!1},this.udtDefined=function(t){return c[i.length+t]!==!1},this.down=function(t,e){var n=f.length;return u.push(n),f.push({name:e,thisIndex:n,thatIndex:null,state:r.SEM_PRE,callbackIndex:t,phraseIndex:null,phraseLength:null,stack:u.length}),n},this.up=function(t,e,n,a){var s=f.length,i=u.pop();return f.push({name:e,thisIndex:s,thatIndex:i,state:r.SEM_POST,callbackIndex:t,phraseIndex:n,phraseLength:a,stack:u.length}),f[i].thatIndex=s,f[i].phraseIndex=n,f[i].phraseLength=a,s},this.translate=function(t){for(var e,n,a,s=0;s<f.length;s+=1)a=f[s],n=p[a.callbackIndex],a.state===r.SEM_PRE?null!==n&&(e=n(r.SEM_PRE,h,a.phraseIndex,a.phraseLength,t),e===r.SEM_SKIP&&(s=a.thatIndex)):null!==n&&n(r.SEM_POST,h,a.phraseIndex,a.phraseLength,t)},this.setLength=function(t){f.length=t,t>0?u.length=f[t-1].stack:u.length=0},this.getLength=function(){return f.length},this.toXml=function(t){var n=a.charsToDec,s="decimal integer character codes";"string"==typeof t&&t.length>=3&&(t=t.slice(0,3).toLowerCase(),"asc"===t?(n=a.charsToAscii,s="ASCII for printing characters, hex for non-printing"):"hex"===t?(n=a.charsToHex,s="hexidecimal integer character codes"):"uni"===t&&(n=a.charsToUnicode,s="Unicode UTF-32 integer character codes"));var i="",o=0;return i+='<?xml version="1.0" encoding="utf-8"?>\n',i+='<root nodes="'+f.length/2+'" characters="'+h.length+'">\n',i+="<!-- input string, "+s+" -->\n",i+=e(o+2),i+=n(h),i+="\n",f.forEach(function(t,a){t.state===r.SEM_PRE?(o+=1,i+=e(o),i+='<node name="'+t.name+'" index="'+t.phraseIndex+'" length="'+t.phraseLength+'">\n',i+=e(o+2),i+=n(h,t.phraseIndex,t.phraseLength),i+="\n"):(i+=e(o),i+='</node><!-- name="'+t.name+'" -->\n',o-=1)}),i+="</root>\n"},this.phrases=function(){var t,e,n={};for(t=0;t<f.length;t+=1)e=f[t],e.state===r.SEM_PRE&&(Array.isArray(n[e.name])||(n[e.name]=[]),n[e.name].push({index:e.phraseIndex,length:e.phraseLength}));return n}}},{"./identifiers.js":5,"./utilities.js":9}],3:[function(t,e,n){e.exports=function(){"use strict;";var t="circular-buffer.js: ",e=-1,n=0;this.init=function(r){if("number"!=typeof r||0>=r)throw new Error(t+"init: circular buffer size must an integer > 0");n=Math.ceil(r),e=-1},this.increment=function(){return e+=1,(e+n)%n},this.maxSize=function(){return n},this.items=function(){return e+1},this.getListIndex=function(t){return-1===e?-1:0>t||t>e?-1:e-t>=n?-1:(t+n)%n},this.forEach=function(t){if(-1!==e)if(n>e)for(var r=0;e>=r;r+=1)t(r,r);else for(var r=e-n+1;e>=r;r+=1){var a=(r+n)%n;t(a,r)}}}},{}],4:[function(t,e,n){"use strict";n.ast=t("./ast.js"),n.circular=t("./circular-buffer.js"),n.ids=t("./identifiers.js"),n.parser=t("./parser.js"),n.stats=t("./stats.js"),n.trace=t("./trace.js"),n.utils=t("./utilities.js")},{"./ast.js":2,"./circular-buffer.js":3,"./identifiers.js":5,"./parser.js":6,"./stats.js":7,"./trace.js":8,"./utilities.js":9}],5:[function(t,e,n){"use strict";e.exports={ALT:1,CAT:2,REP:3,RNM:4,TRG:5,TBS:6,TLS:7,UDT:11,AND:12,NOT:13,BKR:14,BKA:15,BKN:16,ABG:17,AEN:18,ACTIVE:100,MATCH:101,EMPTY:102,NOMATCH:103,SEM_PRE:200,SEM_POST:201,SEM_OK:300,SEM_SKIP:301,ATTR_N:400,ATTR_R:401,ATTR_MR:402,ATTR_NMR:403,ATTR_RMR:404,LOOKAROUND_NONE:500,LOOKAROUND_AHEAD:501,LOOKAROUND_BEHIND:502,BKR_MODE_UM:601,BKR_MODE_PM:602,BKR_MODE_CS:603,BKR_MODE_CI:604}},{}],6:[function(t,e,n){e.exports=function(){"use strict";var e="parser.js: ",n=this,r=t("./identifiers.js"),a=t("./utilities.js");this.ast=null,this.stats=null,this.trace=null,this.callbacks=[];var s,i,o,h,l=0,c=null,p=null,u=0,f=0,d=0,T=null,A=null,g=null,b=null,L=null,C=0,S=1/0,E=1/0,m=function(t,e,n){var a;if(t>=g.length)throw new Error(functionsName+"rule index: "+t+" out of range");if(e>=o)throw new Error(functionsName+"phrase index: "+e+" out of range");a=c.length,c.push({type:r.RNM,index:t}),ht(a,e,n),c.pop()},M=function(t,e,n){var a;if(t>=b.length)throw new Error(functionsName+"udt index: "+t+" out of range");if(e>=o)throw new Error(functionsName+"phrase index: "+e+" out of range");a=c.length,c.push({type:r.UDT,empty:b[t].empty,index:t}),ht(a,e,n),c.pop()},_=function(){l=0,u=0,f=0,d=0,C=0,h=[{lookAround:r.LOOKAROUND_NONE,anchor:0,charsEnd:0,charsLength:0}],g=null,b=null,p=null,s=0,i=0,o=0,T=null,A=null,L=null,c=null},v=function(){var t=[],n=function(){var e={};g.forEach(function(t){t.isBkr&&(e[t.lower]=null)}),b.length>0&&b.forEach(function(t){t.isBkr&&(e[t.lower]=null)}),t.push(e)},r=function(){var e=t[t.length-1],n={};for(var r in e)n[r]=e[r];return n};this.push=function(){t.push(r())},this.pop=function(n){if(n||(n=t.length-1),1>n||n>t.length)throw new Error(e+"backRef.pop(): bad length: "+n);return t.length=n,t[t.length-1]},this.length=function(){return t.length},this.savePhrase=function(e,n,r){t[t.length-1][e]={phraseIndex:n,phraseLength:r}},this.getPhrase=function(e){return t[t.length-1][e]},n()},O=function(){var t=this;this.state=r.ACTIVE,this.phraseLength=0,this.lookAround=h[h.length-1],this.uFrame=new v,this.pFrame=new v,this.evaluateRule=m,this.evaluateUdt=M,this.refresh=function(){t.state=r.ACTIVE,t.phraseLength=0,t.lookAround=h[h.length-1]}},w=function(){return h[h.length-1]},N=function(){return h.length>1},k=function(){return h[h.length-1].lookAround===r.LOOKAROUND_BEHIND},x=function(){for(var t=e+"initializeAst(): ";;){if(void 0===n.ast){n.ast=null;break}if(null===n.ast)break;if("astObject"!==n.ast.astObject)throw new Error(t+"ast object not recognized");break}null!==n.ast&&n.ast.init(g,b,p)},H=function(){for(var t=e+"initializeTrace(): ";;){if(void 0===n.trace){n.trace=null;break}if(null===n.trace)break;if("traceObject"!==n.trace.traceObject)throw new Error(t+"trace object not recognized");break}null!==n.trace&&n.trace.init(g,b,p)},R=function(){for(var t=e+"initializeStats(): ";;){if(void 0===n.stats){n.stats=null;break}if(null===n.stats)break;if("statsObject"!==n.stats.statsObject)throw new Error(t+"stats object not recognized");break}null!==n.stats&&n.stats.init(g,b)},B=function(t){var n=e+"initializeGrammar(): ";if(void 0===t||null===t)throw new Error(n+"grammar object undefined");if("grammarObject"!==t.grammarObject)throw new Error(n+"bad grammar object");g=t.rules,b=t.udts},y=function(t){var n=e+"initializeStartRule(): ",r=null;if("number"==typeof t){if(t>=g.length)throw new Error(n+"start rule index too large: max: "+g.length+": index: "+t);r=t}else{if("string"!=typeof t)throw new Error(n+"type of start rule '"+typeof t+"' not recognized");for(var a=t.toLowerCase(),s=0;s<g.length;s+=1)if(a===g[s].lower){r=g[s].index;break}if(null===r)throw new Error(n+"start rule name '"+t+"' not recognized")}return r},D=function(t,n,r){var h=e+"initializeInputChars(): ";if(void 0===t)throw new Error(h+"input string is undefined");if(null===t)throw new Error(h+"input string is null");if("string"==typeof t)t=a.stringToChars(t);else if(!Array.isArray(t))throw new Error(h+"input string is not a string or array");if(t.length>0&&"number"!=typeof t[0])throw new Error(h+"input string not an array of integers");if("number"!=typeof n)n=0;else if(n=Math.floor(n),0>n||n>t.length)throw new Error(h+"input beginning index out of range: "+n);if("number"!=typeof r)r=t.length-n;else if(r=Math.floor(r),0>r||r>t.length-n)throw new Error(h+"input length out of range: "+r);p=t,s=n,i=r,o=s+i},P=function(){var t,r=e+"initializeCallbacks(): ";for(T=[],A=[],t=0;t<g.length;t+=1)T[t]=null;for(t=0;t<b.length;t+=1)A[t]=null;var a,s=[];for(t=0;t<g.length;t+=1)s.push(g[t].lower);for(t=0;t<b.length;t+=1)s.push(b[t].lower);for(var i in n.callbacks){if(t=s.indexOf(i),0>t)throw new Error(r+"syntax callback '"+i+"' not a rule or udt name");if(a=n.callbacks[i],a===!1&&(a=null),"function"!=typeof a&&null!==a)throw new Error(r+"syntax callback["+i+"] must be function reference or 'false'");t<g.length?T[t]=a:A[t-g.length]=a}for(t=0;t<b.length;t+=1)if(null===A[t])throw new Error(r+"all UDT callbacks must be defined. UDT callback["+b[t].lower+"] not a function reference")};this.setMaxTreeDepth=function(t){if("number"!=typeof t)throw new Error("parser: max tree depth must be integer > 0: "+t);if(S=Math.floor(t),0>=S)throw new Error("parser: max tree depth must be integer > 0: "+t)},this.setMaxNodeHits=function(t){if("number"!=typeof t)throw new Error("parser: max node hits must be integer > 0: "+t);if(E=Math.floor(t),0>=E)throw new Error("parser: max node hits must be integer > 0: "+t)},this.parse=function(t,e,n,r){return _(),D(n,0,n.length),F(t,e,r)},this.parseSubstring=function(t,e,n,r,a,s){return _(),D(n,r,a),F(t,e,s)};var F=function(t,n,a){var h,l,u;switch(h=e+"parse(): ",B(t),n=y(n),P(),H(),R(),x(),l=new O,void 0!==a&&null!==a&&(L=a),c=[{type:r.RNM,index:n}],ht(0,s,l),c=null,l.state){case r.ACTIVE:throw new Error(h+"final state should never be 'ACTIVE'");case r.NOMATCH:u=!1;break;case r.EMPTY:case r.MATCH:u=l.phraseLength===i}return{success:u,state:l.state,length:i,matched:l.phraseLength,maxMatched:C,maxTreeDepth:f,nodeHits:d,inputLength:p.length,subBegin:s,subEnd:o,subLength:i}},I=function(t,e,n){for(var a=c[t],s=0;s<a.children.length&&(ht(a.children[s],e,n),n.state===r.NOMATCH);s+=1);},U=function(t,e,a){var s,i,o,h,l;s=c[t];var p=a.uFrame.length(),u=a.pFrame.length();n.ast&&(o=n.ast.getLength()),i=!0,h=e,l=0;for(var f=0;f<s.children.length;f+=1){if(ht(s.children[f],h,a),a.state===r.NOMATCH){i=!1;break}h+=a.phraseLength,l+=a.phraseLength}i?(a.state=0===l?r.EMPTY:r.MATCH,a.phraseLength=l):(a.state=r.NOMATCH,a.phraseLength=0,a.uFrame.pop(p),a.pFrame.pop(u),n.ast&&n.ast.setLength(o))},K=function(t,e,a){var s,i,h,l,p;s=c[t],h=e,l=0,p=0;var u=a.uFrame.length(),f=a.pFrame.length();for(n.ast&&(i=n.ast.getLength());;){if(h>=o)break;if(ht(t+1,h,a),a.state===r.NOMATCH)break;if(a.state===r.EMPTY)break;if(p+=1,l+=a.phraseLength,h+=a.phraseLength,p===s.max)break}a.state===r.EMPTY?(a.state=0===l?r.EMPTY:r.MATCH,a.phraseLength=l):p>=s.min?(a.state=0===l?r.EMPTY:r.MATCH,a.phraseLength=l):(a.state=r.NOMATCH,a.phraseLength=0,a.uFrame.pop(u),a.pFrame.pop(f),n.ast&&n.ast.setLength(i))},j=function(t,n,a,s){if(n.phraseLength>a){var i=e+"opRNM("+t.name+"): callback function error: ";throw i+="sysData.phraseLength: "+n.phraseLength,i+=" must be <= remaining chars: "+a,new Error(i)}switch(n.state){case r.ACTIVE:if(s!==!0)throw new Error(e+"opRNM("+t.name+"): callback function return error. ACTIVE state not allowed.");break;case r.EMPTY:n.phraseLength=0;break;case r.MATCH:0===n.phraseLength&&(n.state=r.EMPTY);break;case r.NOMATCH:n.phraseLength=0;break;default:throw new Error(e+"opRNM("+t.name+"): callback function return error. Unrecognized return state: "+n.state)}},Y=function(t,e,a){var s,i,h,l,u,f,d,A,b,C;s=c[t],i=g[s.index],h=T[s.index];var S=!N();if(S&&(u=n.ast&&n.ast.ruleDefined(s.index),u&&(l=n.ast.getLength(),f=n.ast.down(s.index,g[s.index].name)),A=a.uFrame.length(),b=a.pFrame.length(),a.uFrame.push(),a.pFrame.push(),C=a.pFrame,a.pFrame=new v),null===h)d=c,c=i.opcodes,ht(0,e,a),c=d;else{var E=o-e;h(a,p,e,L),j(i,a,E,!0),a.state===r.ACTIVE&&(d=c,c=i.opcodes,ht(0,e,a),c=d,h(a,p,e,L),j(i,a,E,!1))}S&&(u&&(a.state===r.NOMATCH?n.ast.setLength(l):n.ast.up(s.index,g[s.index].name,e,a.phraseLength)),a.pFrame=C,a.state===r.NOMATCH?(a.uFrame.pop(A),a.pFrame.pop(b)):g[s.index].isBkr&&(a.pFrame.savePhrase(g[s.index].lower,e,a.phraseLength),a.uFrame.savePhrase(g[s.index].lower,e,a.phraseLength)))},G=function(t,n,a){if(n.phraseLength>a){var s=e+"opUDT("+t.name+"): callback function error: ";throw s+="sysData.phraseLength: "+n.phraseLength,s+=" must be <= remaining chars: "+a,new Error(s)}switch(n.state){case r.ACTIVE:throw new Error(e+"opUDT("+t.name+"): callback function return error. ACTIVE state not allowed.");case r.EMPTY:if(t.empty===!1)throw new Error(e+"opUDT("+t.name+"): callback function return error. May not return EMPTY.");n.phraseLength=0;break;case r.MATCH:if(0===n.phraseLength){if(t.empty===!1)throw new Error(e+"opUDT("+t.name+"): callback function return error. May not return EMPTY.");n.state=r.EMPTY}break;case r.NOMATCH:n.phraseLength=0;break;default:throw new Error(e+"opUDT("+t.name+"): callback function return error. Unrecognized return state: "+n.state)}},V=function(t,e,a){var s,i,h,l,u,f,d,T,C;l=c[t];var S=!N();S&&(f=n.ast&&n.ast.udtDefined(l.index),f&&(h=g.length+l.index,i=n.ast.getLength(),s=n.ast.down(h,b[l.index].name)),d=a.uFrame.length(),T=a.pFrame.length(),a.uFrame.push(),a.pFrame.push(),C=a.pFrame,a.pFrame=new v);var E=o-e;A[l.index](a,p,e,L),G(b[l.index],a,E),S&&(f&&(a.state===r.NOMATCH?n.ast.setLength(i):n.ast.up(h,b[l.index].name,e,a.phraseLength)),a.pFrame=C,a.state===r.NOMATCH?(a.uFrame.pop(d),a.pFrame.pop(T)):b[l.index].isBkr&&(a.pFrame.savePhrase(u[l.index].lower,e,a.phraseLength),a.uFrame.savePhrase(u[l.index].lower,e,a.phraseLength)))},z=function(t,e,n){var a;a=c[t],h.push({lookAround:r.LOOKAROUND_AHEAD,anchor:e,charsEnd:o,charsLength:i}),o=p.length,i=p.length-s,ht(t+1,e,n);var l=h.pop();switch(o=l.charsEnd,i=l.charsLength,n.phraseLength=0,n.state){case r.EMPTY:n.state=r.EMPTY;break;case r.MATCH:n.state=r.EMPTY;break;case r.NOMATCH:n.state=r.NOMATCH;break;default:throw new Error("opAND: invalid state "+n.state)}},X=function(t,e,n){var a;a=c[t],h.push({lookAround:r.LOOKAROUND_AHEAD,anchor:e,charsEnd:o,charsLength:i}),o=p.length,i=p.length-s,ht(t+1,e,n);var l=h.pop();switch(o=l.charsEnd,i=l.charsLength,n.phraseLength=0,n.state){case r.EMPTY:case r.MATCH:n.state=r.NOMATCH;break;case r.NOMATCH:n.state=r.EMPTY;break;default:throw new Error("opNOT: invalid state "+n.state)}},q=function(t,e,n){var a=c[t];n.state=r.NOMATCH,o>e&&a.min<=p[e]&&p[e]<=a.max&&(n.state=r.MATCH,n.phraseLength=1)},J=function(t,e,n){var a,s,i;if(s=c[t],i=s.string.length,n.state=r.NOMATCH,o>=e+i){for(a=0;i>a;a+=1)if(p[e+a]!==s.string[a])return;n.state=r.MATCH,n.phraseLength=i}},Q=function(t,e,n){var a,s,i,h;if(h=c[t],n.state=r.NOMATCH,i=h.string.length,0===i)return void(n.state=r.EMPTY);if(o>=e+i){for(a=0;i>a;a+=1)if(s=p[e+a],s>=65&&90>=s&&(s+=32),s!==h.string[a])return;n.state=r.MATCH,n.phraseLength=i}},W=function(t,e,n){c[t];n.state=r.NOMATCH,n.phraseLength=0,n.state=0===e?r.EMPTY:r.NOMATCH},Z=function(t,e,n){c[t];n.state=r.NOMATCH,n.phraseLength=0,n.state=e===p.length?r.EMPTY:r.NOMATCH},$=function(t,e,n){var a,s,i,h,l,u,f,d,T;if(h=c[t],n.state=r.NOMATCH,f=h.index<g.length?g[h.index].lower:b[h.index-g.length].lower,d=h.bkrMode===r.BKR_MODE_PM?n.pFrame.getPhrase(f):n.uFrame.getPhrase(f),T=h.bkrCase===r.BKR_MODE_CI,null!==d){if(l=d.phraseIndex,i=d.phraseLength,0===i)return void(n.state=r.EMPTY);if(o>=e+i){if(T){for(a=0;i>a;a+=1)if(s=p[e+a],u=p[l+a],s>=65&&90>=s&&(s+=32),u>=65&&90>=u&&(u+=32),s!==u)return;n.state=r.MATCH,n.phraseLength=i}else for(a=0;i>a;a+=1)if(s=p[e+a],u=p[l+a],s!==u)return;n.state=r.MATCH,n.phraseLength=i}}},tt=function(t,e,n){var a;switch(a=c[t],h.push({lookAround:r.LOOKAROUND_BEHIND,anchor:e}),ht(t+1,e,n),h.pop(),n.phraseLength=0,n.state){case r.EMPTY:n.state=r.EMPTY;break;case r.MATCH:n.state=r.EMPTY;break;case r.NOMATCH:n.state=r.NOMATCH;break;default:throw new Error("opBKA: invalid state "+n.state)}},et=function(t,e,n){var a;switch(a=c[t],h.push({lookAround:r.LOOKAROUND_BEHIND,anchor:e}),ht(t+1,e,n),h.pop(),n.phraseLength=0,n.state){case r.EMPTY:case r.MATCH:n.state=r.NOMATCH;break;case r.NOMATCH:n.state=r.EMPTY;break;default:throw new Error("opBKN: invalid state "+n.state)}},nt=function(t,e,a){var s,i,o,h,l,p,u,f;s=c[t],u=a.uFrame.length(),f=a.pFrame.length(),n.ast&&(o=n.ast.getLength()),i=!0,h=e,p=0,l=0;for(var d=s.children.length-1;d>=0;d-=1)if(ht(s.children[d],h,a),h-=a.phraseLength,p+=a.phraseLength,l+=a.phraseLength,a.state===r.NOMATCH){i=!1;break}i?(a.state=0===p?r.EMPTY:r.MATCH,a.phraseLength=p):(a.state=r.NOMATCH,a.phraseLength=0,a.uFrame.pop(u),a.pFrame.pop(f),n.ast&&n.ast.setLength(o))},rt=function(t,e,a){var s,i,o,h,l,p,u;for(s=c[t],o=e,h=0,l=0,p=a.uFrame.length(),u=a.pFrame.length(),n.ast&&(i=n.ast.getLength());;){if(0>=o)break;if(ht(t+1,o,a),a.state===r.NOMATCH)break;if(a.state===r.EMPTY)break;if(l+=1,h+=a.phraseLength,o-=a.phraseLength,l===s.max)break}a.state===r.EMPTY?(a.state=0===h?r.EMPTY:r.MATCH,a.phraseLength=h):l>=s.min?(a.state=0===h?r.EMPTY:r.MATCH,a.phraseLength=h):(a.state=r.NOMATCH,a.phraseLength=0,a.uFrame.pop(p),a.pFrame.pop(u),n.ast&&n.ast.setLength(i))},at=function(t,e,n){var a=c[t];if(n.state=r.NOMATCH,n.phraseLength=0,e>0){var s=p[e-1];a.min<=s&&s<=a.max&&(n.state=r.MATCH,n.phraseLength=1)}},st=function(t,e,n){var a,s,i,o;if(s=c[t],n.state=r.NOMATCH,i=s.string.length,o=e-i,o>=0){for(a=0;i>a;a+=1)if(p[o+a]!==s.string[a])return;n.state=r.MATCH,n.phraseLength=i}},it=function(t,e,n){var a,s,i,o;if(a=c[t],n.state=r.NOMATCH,o=a.string.length,0===o)return void(n.state=r.EMPTY);if(i=e-o,i>=0){for(var h=0;o>h;h+=1)if(s=p[i+h],s>=65&&90>=s&&(s+=32),s!==a.string[h])return;n.state=r.MATCH,n.phraseLength=o}},ot=function(t,e,n){var a,s,i,o,h,l,u,f,d,T;if(o=c[t],n.state=r.NOMATCH,n.phraseLength=0,u=o.index<g.length?g[o.index].lower:b[o.index-g.length].lower,d=o.bkrMode===r.BKR_MODE_PM?n.pFrame.getPhrase(u):n.uFrame.getPhrase(u),T=o.bkrCase===r.BKR_MODE_CI,null!==d){if(h=d.phraseIndex,i=d.phraseLength,0===i)return n.state=r.EMPTY,void(n.phraseLength=0);if(f=e-i,f>=0){if(T){for(a=0;i>a;a+=1)if(s=p[f+a],l=p[h+a],s>=65&&90>=s&&(s+=32),l>=65&&90>=l&&(l+=32),s!==l)return;n.state=r.MATCH,n.phraseLength=i}else for(a=0;i>a;a+=1)if(s=p[f+a],l=p[h+a],s!==l)return;n.state=r.MATCH,n.phraseLength=i}}},ht=function(t,e,a){var s,i=!0;if(s=c[t],d+=1,d>E)throw new Error("parser: maximum number of node hits exceeded: "+E);if(u+=1,u>f&&(f=u,f>S))throw new Error("parser: maximum parse tree depth exceeded: "+S);if(a.refresh(),null!==n.trace){var o=w();n.trace.down(s,a.state,e,a.phraseLength,o.anchor,o.lookAround)}if(k())switch(s.type){case r.ALT:I(t,e,a);break;case r.CAT:nt(t,e,a);break;case r.REP:rt(t,e,a);break;case r.RNM:Y(t,e,a);break;case r.UDT:V(t,e,a);break;case r.AND:z(t,e,a);break;case r.NOT:X(t,e,a);break;case r.TRG:at(t,e,a);break;case r.TBS:st(t,e,a);break;case r.TLS:it(t,e,a);break;case r.BKR:ot(t,e,a);break;case r.BKA:tt(t,e,a);break;case r.BKN:et(t,e,a);break;case r.ABG:W(t,e,a);break;case r.AEN:Z(t,e,a);break;default:i=!1}else switch(s.type){case r.ALT:I(t,e,a);break;case r.CAT:U(t,e,a);break;case r.REP:K(t,e,a);break;case r.RNM:Y(t,e,a);break;case r.UDT:V(t,e,a);break;case r.AND:z(t,e,a);break;case r.NOT:X(t,e,a);break;case r.TRG:q(t,e,a);break;case r.TBS:J(t,e,a);break;case r.TLS:Q(t,e,a);break;case r.BKR:$(t,e,a);break;case r.BKA:tt(t,e,a);break;case r.BKN:et(t,e,a);break;case r.ABG:W(t,e,a);break;case r.AEN:Z(t,e,a);break;default:i=!1}if(!N()&&e+a.phraseLength>C&&(C=e+a.phraseLength),null!==n.stats&&n.stats.collect(s,a),null!==n.trace){var o=w();n.trace.up(s,a.state,e,a.phraseLength,o.anchor,o.lookAround)}return u-=1,i}}},{"./identifiers.js":5,"./utilities.js":9}],7:[function(t,e,n){e.exports=function(){"use strict";var e,n="stats.js: ",r=t("./identifiers.js"),a=t("./utilities"),s=a.styleNames,i=[],o=[],h=[],l=[],c=[];this.statsObject="statsObject";var p="stats",u=function(t,e){return t.lower<e.lower?-1:t.lower>e.lower?1:0},f=function(t,e){return t.total<e.total?1:t.total>e.total?-1:u(t,e)},d=function(t,e){return t.index<e.index?-1:t.index>e.index?1:0},T=function(){this.empty=0,this.match=0,this.nomatch=0,this.total=0},A=function(){h.length=0,e=new T,h[r.ALT]=new T,h[r.CAT]=new T,h[r.REP]=new T,h[r.RNM]=new T,h[r.TRG]=new T,h[r.TBS]=new T,h[r.TLS]=new T,h[r.UDT]=new T,h[r.AND]=new T,h[r.NOT]=new T,h[r.BKR]=new T,h[r.BKA]=new T,h[r.BKN]=new T,l.length=0;for(var t=0;t<i.length;t+=1)l.push({empty:0,match:0,nomatch:0,total:0,name:i[t].name,lower:i[t].lower,index:i[t].index});if(o.length>0){c.length=0;for(var t=0;t<o.length;t+=1)c.push({empty:0,match:0,nomatch:0,total:0,name:o[t].name,lower:o[t].lower,index:o[t].index})}},g=function(t,e,a){switch(t.total+=1,e){case r.EMPTY:t.empty+=1;break;case r.MATCH:t.match+=1;break;case r.NOMATCH:t.nomatch+=1;break;default:throw n+"collect(): incStat(): unrecognized state: "+e}},b=function(t,e){var n="";return n+="<tr>",n+='<td class="'+s.CLASS_ACTIVE+'">'+t+"</td>",n+='<td class="'+s.CLASS_EMPTY+'">'+e.empty+"</td>",n+='<td class="'+s.CLASS_MATCH+'">'+e.match+"</td>",n+='<td class="'+s.CLASS_NOMATCH+'">'+e.nomatch+"</td>",n+='<td class="'+s.CLASS_ACTIVE+'">'+e.total+"</td>",n+="</tr>\n"},L=function(){var t="";return t+=b("ALT",h[r.ALT]),t+=b("CAT",h[r.CAT]),t+=b("REP",h[r.REP]),t+=b("RNM",h[r.RNM]),t+=b("TRG",h[r.TRG]),t+=b("TBS",h[r.TBS]),t+=b("TLS",h[r.TLS]),t+=b("UDT",h[r.UDT]),t+=b("AND",h[r.AND]),t+=b("NOT",h[r.NOT]),t+=b("BKR",h[r.BKR]),t+=b("BKA",h[r.BKA]),t+=b("BKN",h[r.BKN]),t+=b("totals",e)},C=function(){var t="";t+="<tr><th></th><th></th><th></th><th></th><th></th></tr>\n",t+="<tr><th>rules</th><th></th><th></th><th></th><th></th></tr>\n";for(var e=0;e<i.length;e+=1)l[e].total>0&&(t+="<tr>",t+='<td class="'+s.CLASS_ACTIVE+'">'+l[e].name+"</td>",t+='<td class="'+s.CLASS_EMPTY+'">'+l[e].empty+"</td>",t+='<td class="'+s.CLASS_MATCH+'">'+l[e].match+"</td>",t+='<td class="'+s.CLASS_NOMATCH+'">'+l[e].nomatch+"</td>",t+='<td class="'+s.CLASS_ACTIVE+'">'+l[e].total+"</td>",t+="</tr>\n");if(o.length>0){t+="<tr><th></th><th></th><th></th><th></th><th></th></tr>\n",t+="<tr><th>udts</th><th></th><th></th><th></th><th></th></tr>\n";for(var e=0;e<o.length;e+=1)c[e].total>0&&(t+="<tr>",t+='<td class="'+s.CLASS_ACTIVE+'">'+c[e].name+"</td>",t+='<td class="'+s.CLASS_EMPTY+'">'+c[e].empty+"</td>",t+='<td class="'+s.CLASS_MATCH+'">'+c[e].match+"</td>",t+='<td class="'+s.CLASS_NOMATCH+'">'+c[e].nomatch+"</td>",t+='<td class="'+s.CLASS_ACTIVE+'">'+c[e].total+"</td>",t+="</tr>\n")}return t};this.validate=function(t){var e=!1;return"string"==typeof t&&p===t&&(e=!0),e},this.init=function(t,e){i=t,o=e,A()},this.collect=function(t,n){g(e,n.state,n.phraseLength),g(h[t.type],n.state,n.phraseLength),t.type===r.RNM&&g(l[t.index],n.state,n.phraseLength),t.type===r.UDT&&g(c[t.index],n.state,n.phraseLength)},this.toHtml=function(t,e){var n="";for(n+='<table class="'+s.CLASS_RIGHT_TABLE+'">\n',"string"==typeof e&&(n+="<caption>"+e+"</caption>\n"),n+='<tr><th class="'+s.CLASS_ACTIVE+'">ops</th>\n',n+='<th class="'+s.CLASS_EMPTY+'">EMPTY</th>\n',n+='<th class="'+s.CLASS_MATCH+'">MATCH</th>\n',n+='<th class="'+s.CLASS_NOMATCH+'">NOMATCH</th>\n',n+='<th class="'+s.CLASS_ACTIVE+'">totals</th></tr>\n';;){if(void 0===t){n+=L();break}if(null===t){n+=L();break}if("ops"===t){n+=L();break}if("index"===t){l.sort(d),c.length>0&&c.sort(d),n+=L(),n+=C();break}if("hits"===t){l.sort(f),c.length>0&&c.sort(d),n+=L(),n+=C();break}if("alpha"===t){l.sort(u),c.length>0&&c.sort(u),n+=L(),n+=C();break}break}return n+="</table><br>\n"},this.toHtmlPage=function(t,e,n){return a.htmlToPage(this.toHtml(t,e),n)}}},{"./identifiers.js":5,"./utilities":9}],8:[function(t,e,n){e.exports=function(){"use strict";var e="trace.js: ",n=this,r=16,a=10,s=8,i=32,o=80,h=5,l=t("./utilities.js"),c=l.styleNames,p=new(t("./circular-buffer.js")),u=t("./identifiers.js"),f=[],d=5e3,T=0,A=0,g=0,b=[],L=null,C=null,S=null,E=[],m=[],M='<span class="'+c.CLASS_END+'">&bull;</span>',_='<span class="'+c.CLASS_END+'">&hellip;</span>',v='<span class="'+c.CLASS_EMPTY+'">&#120634;</span>',O=('<span class="'+c.CLASS_NOMATCH+'">&#120636;</span>',function(){var t,r=function(t){E[u.ALT]=t,E[u.CAT]=t,E[u.REP]=t,E[u.TLS]=t,E[u.TBS]=t,E[u.TRG]=t,E[u.AND]=t,E[u.NOT]=t,E[u.BKR]=t,E[u.BKA]=t,E[u.BKN]=t,E[u.ABG]=t,E[u.AEN]=t},a=0;for(var s in n.filter.operators)a+=1;if(0===a)r(!1);else{t=!1;for(var s in n.filter.operators){var i=s.toUpperCase();if("<ALL>"===i){r(!0),t=!0;break}if("<NONE>"===i){r(!1),t=!0;break}}if(t===!1){r(!1);for(var s in n.filter.operators){var i=s.toUpperCase();if("ALT"===i)E[u.ALT]=!0;else if("CAT"===i)E[u.CAT]=!0;else if("REP"===i)E[u.REP]=!0;else if("AND"===i)E[u.AND]=!0;else if("NOT"===i)E[u.NOT]=!0;else if("TLS"===i)E[u.TLS]=!0;else if("TBS"===i)E[u.TBS]=!0;else if("TRG"===i)E[u.TRG]=!0;else if("BKR"===i)E[u.BKR]=!0;else if("BKA"===i)E[u.BKA]=!0;else if("BKN"===i)E[u.BKN]=!0;else if("ABG"===i)E[u.ABG]=!0;else{if("AEN"!==i)throw new Error(e+"initOpratorFilter: '"+s+"' not a valid operator name. Must be <all>, <none>, alt, cat, rep, tls, tbs, trg, and, not, bkr, bka or bkn");E[u.AEN]=!0}}}}}),w=function(){var t,r,a,s=function(t){E[u.RNM]=t,E[u.UDT]=t;var e=C.length+S.length;m.length=0;for(var n=0;e>n;n+=1)m.push(t)},i=[];for(a=0;a<C.length;a+=1)i.push(C[a].lower);for(a=0;a<S.length;a+=1)i.push(S[a].lower);m.length=0,r=0;for(var o in n.filter.rules)r+=1;if(0===r)s(!0);else{t=!1;for(var o in n.filter.rules){var h=o.toLowerCase();if("<all>"===h){s(!0),t=!0;break}if("<none>"===h){s(!1),t=!0;break}}if(t===!1){s(!1);for(var o in n.filter.rules){var h=o.toLowerCase();if(a=i.indexOf(h),0>a)throw new Error(e+"initRuleFilter: '"+o+"' not a valid rule or udt name");m[a]=!0}E[u.RNM]=!0,E[u.UDT]=!0}}};this.traceObject="traceObject",this.filter={operators:[],rules:[]},this.setMaxRecords=function(t){"number"==typeof t&&t>0&&(d=Math.ceil(t))},this.getMaxRecords=function(){return d},this.init=function(t,e,n){f.length=0,b.length=0,T=0,A=0,g=0,L=n,C=t,S=e,O(),w(),p.init(d)};var N=function(t){var e=!1;return e=t.type===u.RNM?!(!E[t.type]||!m[t.index]):t.type===u.UDT?!(!E[t.type]||!m[C.length+t.index]):E[t.type]};this.down=function(t,e,n,r,a,s){T+=1,N(t)&&(b.push(A),f[p.increment()]={dirUp:!1,depth:g,thisLine:A,thatLine:void 0,opcode:t,state:e,phraseIndex:n,phraseLength:r,lookAnchor:a,lookAround:s},A+=1,g+=1)},this.up=function(t,e,n,r,a,s){if(T+=1,N(t)){var i=A,o=b.pop(),h=p.getListIndex(o);-1!==h&&(f[h].thatLine=i),g-=1,f[p.increment()]={dirUp:!0,depth:g,thisLine:i,thatLine:o,opcode:t,state:e,phraseIndex:n,phraseLength:r,lookAnchor:a,lookAround:s},A+=1}},this.toHtml=function(t,e){var n=s;if("string"==typeof t&&t.length>=3){var o=t.toLowerCase().slice(0,3);"hex"===o?n=r:"dec"===o?n=a:"uni"===o&&(n=i)}var h="";return h+=k(n,e),h+=H(n),h+=x()},this.toHtmlPage=function(t,e,n){return l.htmlToPage(this.toHtml(t,e),n)};var k=function(t,n){var o;switch(t){case r:o="hexidecimal";break;case a:o="decimal";break;case s:o="ASCII";break;case i:o="UNICODE";break;default:throw new Error(e+"htmlHeader: unrecognized mode: "+t)}var h="";return h+="<h1>JavaScript APG Trace</h1>\n",h+="<h3>&nbsp;&nbsp;&nbsp;&nbsp;display mode: "+o+"</h3>\n",h+="<h5>&nbsp;&nbsp;&nbsp;&nbsp;"+new Date+"</h5>\n",h+='<table class="'+c.CLASS_LAST2_LEFT_TABLE+'">\n',"string"==typeof n&&(h+="<caption>"+n+"</caption>"),h},x=function(){var t="";return t+="</table>\n",t+='<p class="'+c.CLASS_MONOSPACE+'">legend:<br>\n',t+="(a)&nbsp;-&nbsp;line number<br>\n",t+="(b)&nbsp;-&nbsp;matching line number<br>\n",t+="(c)&nbsp;-&nbsp;phrase offset<br>\n",t+="(d)&nbsp;-&nbsp;phrase length<br>\n",t+="(e)&nbsp;-&nbsp;tree depth<br>\n",t+="(f)&nbsp;-&nbsp;operator state<br>\n",t+='&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="'+c.CLASS_ACTIVE+'">&darr;</span>&nbsp;&nbsp;phrase opened<br>\n',t+='&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="'+c.CLASS_MATCH+'">&uarr;M</span> phrase matched<br>\n',t+='&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="'+c.CLASS_EMPTY+'">&uarr;E</span> empty phrase matched<br>\n',t+='&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="'+c.CLASS_NOMATCH+'">&uarr;N</span> phrase not matched<br>\n',t+="operator&nbsp;-&nbsp;ALT, CAT, REP, RNM, TRG, TLS, TBS<sup>&dagger;</sup>, UDT, AND, NOT, BKA, BKN, BKR, ABG, AEN<sup>&Dagger;</sup><br>\n",t+="phrase&nbsp;&nbsp;&nbsp;-&nbsp;up to "+o+" characters of the phrase being matched<br>\n",t+='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="'+c.CLASS_MATCH+'">matched characters</span><br>\n',t+='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="'+c.CLASS_LH_MATCH+'">matched characters in look ahead mode</span><br>\n',t+='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="'+c.CLASS_LB_MATCH+'">matched characters in look behind mode</span><br>\n',t+='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="'+c.CLASS_REMAINDER+'">remainder characters(not yet examined by parser)</span><br>\n',t+='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="'+c.CLASS_CTRL+'">control characters, TAB, LF, CR, etc. (ASCII mode only)</span><br>\n',t+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;"+v+" empty string<br>\n",t+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;"+M+" end of input string<br>\n",t+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;"+_+" input string display truncated<br>\n",t+="</p>\n",t+='<p class="'+c.CLASS_MONOSPACE+'">\n',t+="<sup>&dagger;</sup>original ABNF operators:<br>\n",t+="ALT - alternation<br>\n",t+="CAT - concatenation<br>\n",t+="REP - repetition<br>\n",t+="RNM - rule name<br>\n",t+="TRG - terminal range<br>\n",t+="TLS - terminal literal string (case insensitive)<br>\n",t+="TBS - terminal binary string (case sensitive)<br>\n",t+="<br>\n",t+="<sup>&Dagger;</sup>super set SABNF operators:<br>\n",t+="UDT - user-defined terminal<br>\n",t+="AND - positive look ahead<br>\n",t+="NOT - negative look ahead<br>\n",t+="BKA - positive look behind<br>\n",t+="BKN - negative look behind<br>\n",t+="BKR - back reference<br>\n",t+="ABG - anchor - begin of input string<br>\n",t+="AEN - anchor - end of input string<br>\n",t+="</p>\n",t+="</body>\n",t+="</html>\n"},H=function(t){if(null===C)return"";var e,r,a,s,i,o,h="";return h+="<tr><th>(a)</th><th>(b)</th><th>(c)</th><th>(d)</th><th>(e)</th><th>(f)</th>",h+="<th>operator</th><th>phrase</th></tr>\n",p.forEach(function(p,d){var T=f[p];switch(e=T.thisLine,r=void 0!==T.thatLine?T.thatLine:"--",a=!1,s=!1,i=!1,T.lookAround===u.LOOKAROUND_AHEAD&&(a=!0,i=!0,o=T.lookAnchor),T.opcode.type!==u.AND&&T.opcode.type!==u.NOT||(a=!0,i=!0,o=T.phraseIndex),T.lookAround===u.LOOKAROUND_BEHIND&&(s=!0,i=!0,o=T.lookAnchor),T.opcode.type!==u.BKA&&T.opcode.type!==u.BKN||(s=!0,i=!0,o=T.phraseIndex),h+="<tr>",h+="<td>"+e+"</td><td>"+r+"</td>",h+="<td>"+T.phraseIndex+"</td>",h+="<td>"+T.phraseLength+"</td>",h+="<td>"+T.depth+"</td>",h+="<td>",T.state){case u.ACTIVE:h+='<span class="'+c.CLASS_ACTIVE+'">&darr;&nbsp;</span>';break;case u.MATCH:h+='<span class="'+c.CLASS_MATCH+'">&uarr;M</span>';break;case u.NOMATCH:h+='<span class="'+c.CLASS_NOMATCH+'">&uarr;N</span>';break;case u.EMPTY:h+='<span class="'+c.CLASS_EMPTY+'">&uarr;E</span>';break;default:h+='<span class="'+c.CLASS_ACTIVE+'">--</span>'}if(h+="</td>",h+="<td>",h+=n.indent(T.depth),a?h+='<span class="'+c.CLASS_LH_MATCH+'">':s&&(h+='<span class="'+c.CLASS_LB_MATCH+'">'),h+=l.opcodeToString(T.opcode.type),T.opcode.type===u.RNM&&(h+="("+C[T.opcode.index].name+") "),T.opcode.type===u.BKR){var A=T.opcode.bkrCase===u.BKR_MODE_CI?"%i":"%s",g=T.opcode.bkrMode===u.BKR_MODE_UM?"%u":"%p";h+="(\\"+A+g+C[T.opcode.index].name+") "}T.opcode.type===u.UDT&&(h+="("+S[T.opcode.index].name+") "),
T.opcode.type===u.TRG&&(h+="("+R(t,T.opcode)+") "),T.opcode.type===u.TBS&&(h+="("+y(t,T.opcode)+") "),T.opcode.type===u.TLS&&(h+="("+D(t,T.opcode)+") "),T.opcode.type===u.REP&&(h+="("+B(t,T.opcode)+") "),i&&(h+="</span>"),h+="</td>",h+="<td>",h+=s?P(t,L,T.state,T.phraseIndex,T.phraseLength,o):a?F(t,L,T.state,T.phraseIndex,T.phraseLength):I(t,L,T.state,T.phraseIndex,T.phraseLength),h+="</td></tr>\n"}),h+="<tr><th>(a)</th><th>(b)</th><th>(c)</th><th>(d)</th><th>(e)</th><th>(f)</th>",h+="<th>operator</th><th>phrase</th></tr>\n",h+="</table>\n"};this.indent=function(t){for(var e="",n=0;t>n;n+=1)e+=".";return e};var R=function(t,e){var n="";if(e.type===u.TRG){var a;t===r||t===i?(a=e.min.toString(16).toUpperCase(),a.length%2!==0&&(a="0"+a),n+=t===r?"%x":"U+",n+=a,a=e.max.toString(16).toUpperCase(),a.length%2!==0&&(a="0"+a),n+="&ndash;"+a):n="%d"+e.min.toString(10)+"&ndash;"+e.max.toString(10)}return n},B=function(t,e){var n="";if(e.type===u.REP){var a;t===r?(a=e.min.toString(16).toUpperCase(),a.length%2!==0&&(a="0"+a),n="x"+a,e.max<1/0?(a=e.max.toString(16).toUpperCase(),a.length%2!==0&&(a="0"+a)):a="inf",n+="&ndash;"+a):n=e.max<1/0?e.min.toString(10)+"&ndash;"+e.max.toString(10):e.min.toString(10)+"&ndash;inf"}return n},y=function(t,e){var n="";if(e.type===u.TBS){var a=Math.min(e.string.length,2*h);if(t===r||t===i){n+=t===r?"%x":"U+";for(var s=0;a>s;s+=1){var o;s>0&&(n+="."),o=e.string[s].toString(16).toUpperCase(),o.length%2!==0&&(o="0"+o),n+=o}}else{n="%d";for(var s=0;a>s;s+=1)s>0&&(n+="."),n+=e.string[s].toString(10)}a<e.string.length&&(n+=_)}return n},D=function(t,e){var n="";if(e.type===u.TLS){var s=Math.min(e.string.length,h);if(t===r||t===a){var i,o,c;t===r?(n="%x",c=16):(n="%d",c=10);for(var p=0;s>p;p+=1)p>0&&(n+="."),o=e.string[p],o>=97&&122>=o?(i=o-32,n+=(i.toString(c)+"/"+o.toString(c)).toUpperCase()):o>=65&&90>=o?(i=o,o+=32,n+=(i.toString(c)+"/"+o.toString(c)).toUpperCase()):n+=o.toString(c).toUpperCase();s<e.string.length&&(n+=_)}else{n='"';for(var p=0;s>p;p+=1)n+=l.asciiChars[e.string[p]];s<e.string.length&&(n+=_),n+='"'}}return n},P=function(t,e,n,r,a,s){var i,h,l,p,f="",d=M,T='<span class="'+c.CLASS_LB_MATCH+'">',A='<span class="'+c.CLASS_REMAINDER+'">',g="</span>",b=!1;switch(n){case u.EMPTY:f+=v;case u.NOMATCH:case u.MATCH:case u.ACTIVE:i=r-a,h=s-i,l=s,p=e.length-l}return d=M,h>o?(h=o,d=_,p=0):h+p>o&&(d=_,p=o-h),h>0&&(f+=T,f+=K(t,e,i,h,b),f+=g,b=!0),p>0&&(f+=A,f+=K(t,e,l,p,b),f+=g),f+d},F=function(t,e,n,r,a){var s='<span class="'+c.CLASS_LH_MATCH+'">';return U(t,e,n,r,a,s)},I=function(t,e,n,r,a){var s='<span class="'+c.CLASS_MATCH+'">';return U(t,e,n,r,a,s)},U=function(t,e,n,r,a,s){var i,h,l,p,f="",d=M,T='<span class="'+c.CLASS_REMAINDER+'">',A="</span>",g=!1;switch(n){case u.EMPTY:f+=v;case u.NOMATCH:case u.ACTIVE:i=r,h=0,l=r,p=e.length-l;break;case u.MATCH:i=r,h=a,l=r+h,p=e.length-l}return d=M,h>o?(h=o,d=_,p=0):h+p>o&&(d=_,p=o-h),h>0&&(f+=s,f+=K(t,e,i,h,g),f+=A,g=!0),p>0&&(f+=T,f+=K(t,e,l,p,g),f+=A),f+d},K=function(t,e,n,o,h){if(0===o)return"";var c="",p=h?",":"";switch(t){case r:c=p+l.charsToHex(e,n,o);break;case a:if(h)return","+l.charsToDec(e,n,o);c=p+l.charsToDec(e,n,o);break;case i:c=p+l.charsToUnicode(e,n,o);break;case s:default:c=l.charsToAsciiHtml(e,n,o)}return c}}},{"./circular-buffer.js":3,"./identifiers.js":5,"./utilities.js":9}],9:[function(t,e,n){"use strict";var r="utilities.js: ",a=this,s=function(t,e,n){for(var r;;){if(0>=t){e=0,r=0;break}if("number"!=typeof e){e=0,r=t;break}if(e>=t){e=t,r=t;break}if("number"!=typeof n){r=t;break}if(r=e+n,r>t){r=t;break}break}return{beg:e,end:r}},i={COLOR_ACTIVE:"#000000",COLOR_MATCH:"#264BFF",COLOR_EMPTY:"#0fbd0f",COLOR_NOMATCH:"#FF4000",COLOR_LH_MATCH:"#1A97BA",COLOR_LB_MATCH:"#5F1687",COLOR_LH_NOMATCH:"#FF8000",COLOR_LB_NOMATCH:"#e6ac00",COLOR_END:"#000000",COLOR_CTRL:"#000000",COLOR_REMAINDER:"#999999",COLOR_TEXT:"#000000",COLOR_BACKGROUND:"#FFFFFF",COLOR_BORDER:"#000000",CLASS_ACTIVE:"apg-active",CLASS_MATCH:"apg-match",CLASS_NOMATCH:"apg-nomatch",CLASS_EMPTY:"apg-empty",CLASS_LH_MATCH:"apg-lh-match",CLASS_LB_MATCH:"apg-lb-match",CLASS_REMAINDER:"apg-remainder",CLASS_CTRL:"apg-ctrl-char",CLASS_END:"apg-line-end",CLASS_LEFT_TABLE:"apg-left-table",CLASS_RIGHT_TABLE:"apg-right-table",CLASS_LAST_LEFT_TABLE:"apg-last-left-table",CLASS_LAST2_LEFT_TABLE:"apg-last2-left-table",CLASS_MONOSPACE:"apg-mono"};n.styleNames=i;var o=function(){var t="";return t+="."+i.CLASS_MONOSPACE+"{font-family: monospace;}\n",t+="."+i.CLASS_ACTIVE+"{font-weight: bold; color: "+i.COLOR_TEXT+";}\n",t+="."+i.CLASS_MATCH+"{font-weight: bold; color: "+i.COLOR_MATCH+";}\n",t+="."+i.CLASS_EMPTY+"{font-weight: bold; color: "+i.COLOR_EMPTY+";}\n",t+="."+i.CLASS_NOMATCH+"{font-weight: bold; color: "+i.COLOR_NOMATCH+";}\n",t+="."+i.CLASS_LH_MATCH+"{font-weight: bold; color: "+i.COLOR_LH_MATCH+";}\n",t+="."+i.CLASS_LB_MATCH+"{font-weight: bold; color: "+i.COLOR_LB_MATCH+";}\n",t+="."+i.CLASS_REMAINDER+"{font-weight: bold; color: "+i.COLOR_REMAINDER+";}\n",t+="."+i.CLASS_CTRL+"{font-weight: bolder; font-style: italic; font-size: .6em;}\n",t+="."+i.CLASS_END+"{font-weight: bold; color: "+i.COLOR_END+";}\n"},h=function(){var t="";return t+="."+i.CLASS_LEFT_TABLE+"{font-family:monospace;}\n",t+="."+i.CLASS_LEFT_TABLE+",\n",t+="."+i.CLASS_LEFT_TABLE+" th,\n",t+="."+i.CLASS_LEFT_TABLE+" td{text-align:left;border:1px solid black;border-collapse:collapse;}\n",t+="."+i.CLASS_LEFT_TABLE+" caption",t+="{font-size:125%;font-weight:bold;text-align:left;}\n"},l=function(){var t="";return t+="."+i.CLASS_RIGHT_TABLE+"{font-family:monospace;}\n",t+="."+i.CLASS_RIGHT_TABLE+",\n",t+="."+i.CLASS_RIGHT_TABLE+" th,\n",t+="."+i.CLASS_RIGHT_TABLE+" td{text-align:right;border:1px solid black;border-collapse:collapse;}\n",t+="."+i.CLASS_RIGHT_TABLE+" caption",t+="{font-size:125%;font-weight:bold;text-align:left;}\n"},c=function(){var t="";return t+="."+i.CLASS_LAST_LEFT_TABLE+"{font-family:monospace;}\n",t+="."+i.CLASS_LAST_LEFT_TABLE+",\n",t+="."+i.CLASS_LAST_LEFT_TABLE+" th,\n",t+="."+i.CLASS_LAST_LEFT_TABLE+" td{text-align:right;border:1px solid black;border-collapse:collapse;}\n",t+="."+i.CLASS_LAST_LEFT_TABLE+" th:last-child{text-align:left;}\n",t+="."+i.CLASS_LAST_LEFT_TABLE+" td:last-child{text-align:left;}\n",t+="."+i.CLASS_LAST_LEFT_TABLE+" caption",t+="{font-size:125%;font-weight:bold;text-align:left;}\n"},p=function(){var t="";return t+="."+i.CLASS_LAST2_LEFT_TABLE+"{font-family:monospace;}\n",t+="."+i.CLASS_LAST2_LEFT_TABLE+",\n",t+="."+i.CLASS_LAST2_LEFT_TABLE+" th,\n",t+="."+i.CLASS_LAST2_LEFT_TABLE+" td{text-align:right;border:1px solid black;border-collapse:collapse;}\n",t+="."+i.CLASS_LAST2_LEFT_TABLE+" th:last-child{text-align:left;}\n",t+="."+i.CLASS_LAST2_LEFT_TABLE+" th:nth-last-child(2){text-align:left;}\n",t+="."+i.CLASS_LAST2_LEFT_TABLE+" td:last-child{text-align:left;}\n",t+="."+i.CLASS_LAST2_LEFT_TABLE+" td:nth-last-child(2){text-align:left;}\n",t+="."+i.CLASS_LAST2_LEFT_TABLE+" caption",t+="{font-size:125%;font-weight:bold;text-align:left;}\n"};n.css=function(){var t="";return t+=o(),t+=h(),t+=l(),t+=c(),t+=p()},n.styleClasses=function(){var t="<style>\n";return t+=o(),t+="</style>\n"},n.styleLeftTable=function(){var t="<style>\n";return t+=h(),t+="</style>\n"},n.styleRightTable=function(){var t="<style>\n";return t+=l(),t+="</style>\n"},n.styleLastLeftTable=function(){var t="<style>\n";return t+=c(),t+="</style>\n"},n.styleLast2LeftTable=function(){var t="<style>\n";return t+=p(),t+="</style>\n"},n.htmlToPage=function(t,e){var r="utilities.js: ";if("string"!=typeof t)throw new Error(r+"htmlToPage: input HTML is not a string");"string"!=typeof e&&(e="htmlToPage");var a="";return a+="<!DOCTYPE html>\n",a+='<html lang="en">\n',a+="<head>\n",a+='<meta charset="utf-8">\n',a+="<title>"+e+"</title>\n",a+=n.styleClasses(),a+=n.styleLeftTable(),a+=n.styleRightTable(),a+=n.styleLastLeftTable(),a+=n.styleLast2LeftTable(),a+="</head>\n<body>\n",a+="<p>"+new Date+"</p>\n",a+=t,a+="</body>\n</html>\n"},n.parserResultToHtml=function(e,n){var r=t("./identifiers.js"),a=null;""!==n&&(a=n);var s,o;s=e.success===!0?'<span class="'+i.CLASS_MATCH+'">true</span>':'<span class="'+i.CLASS_NOMATCH+'">false</span>',o=e.state===r.EMPTY?'<span class="'+i.CLASS_EMPTY+'">EMPTY</span>':e.state===r.MATCH?'<span class="'+i.CLASS_MATCH+'">MATCH</span>':e.state===r.NOMATCH?'<span class="'+i.CLASS_NOMATCH+'">NOMATCH</span>':'<span class="'+i.CLASS_NOMATCH+'">unrecognized</span>';var h="";return h+='<p><table class="'+i.CLASS_LEFT_TABLE+'">\n',a&&(h+="<caption>"+a+"</caption>\n"),h+="<tr><th>state item</th><th>value</th><th>description</th></tr>\n",h+="<tr><td>parser success</td><td>"+s+"</td>\n",h+='<td><span class="'+i.CLASS_MATCH+'">true</span> if the parse succeeded,\n',h+=' <span class="'+i.CLASS_NOMATCH+'">false</span> otherwise',h+="<br><i>NOTE: for success, entire string must be matched</i></td></tr>\n",h+="<tr><td>parser state</td><td>"+o+"</td>\n",h+='<td><span class="'+i.CLASS_EMPTY+'">EMPTY</span>, ',h+='<span class="'+i.CLASS_MATCH+'">MATCH</span> or \n',h+='<span class="'+i.CLASS_NOMATCH+'">NOMATCH</span></td></tr>\n',h+="<tr><td>string length</td><td>"+e.length+"</td><td>length of the input (sub)string</td></tr>\n",h+="<tr><td>matched length</td><td>"+e.matched+"</td><td>number of input string characters matched</td></tr>\n",h+="<tr><td>max matched</td><td>"+e.maxMatched+"</td><td>maximum number of input string characters matched</td></tr>\n",h+="<tr><td>max tree depth</td><td>"+e.maxTreeDepth+"</td><td>maximum depth of the parse tree reached</td></tr>\n",h+="<tr><td>node hits</td><td>"+e.nodeHits+"</td><td>number of parse tree node hits (opcode function calls)</td></tr>\n",h+="<tr><td>input length</td><td>"+e.inputLength+"</td><td>length of full input string</td></tr>\n",h+="<tr><td>sub-string begin</td><td>"+e.subBegin+"</td><td>sub-string first character index</td></tr>\n",h+="<tr><td>sub-string end</td><td>"+e.subEnd+"</td><td>sub-string end-of-string index</td></tr>\n",h+="<tr><td>sub-string length</td><td>"+e.subLength+"</td><td>sub-string length</td></tr>\n",h+="</table></p>\n"},n.charsToString=function(t,e,n){var r="";if(Array.isArray(t)){var a="number"==typeof e?e:0,s="number"==typeof n?n:t.length;s>t.length&&(s=t.length);for(var i=a+s,o=a;i>o;o+=1)t[o]&&(r+=String.fromCharCode(t[o]))}return r},n.stringToChars=function(t){var e=[];if("string"==typeof t)for(var n=0;n<t.length;)e[n]=t.charCodeAt(n),n+=1;return e},n.opcodeToString=function(e){var n=t("./identifiers.js"),r="unknown";switch(e){case n.ALT:r="ALT";break;case n.CAT:r="CAT";break;case n.RNM:r="RNM";break;case n.UDT:r="UDT";break;case n.AND:r="AND";break;case n.NOT:r="NOT";break;case n.REP:r="REP";break;case n.TRG:r="TRG";break;case n.TBS:r="TBS";break;case n.TLS:r="TLS";break;case n.BKR:r="BKR";break;case n.BKA:r="BKA";break;case n.BKN:r="BKN";break;case n.ABG:r="ABG";break;case n.AEN:r="AEN"}return r},n.asciiChars=["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","BS","TAB","LF","VT","FF","CR","SO","SI","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","EM","SUB","ESC","FS","GS","RS","US","&nbsp;","!","&#34;","#","$","%","&#38;","&#39;","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","&#60;","=","&#62;","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","&#92;","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","DEL"],n.charToHex=function(t){var e=t.toString(16).toUpperCase();switch(e.length){case 1:case 3:case 7:e="0"+e;break;case 6:e="00"+e;break;case 5:e="000"+e}return e},n.charsToDec=function(t,e,n){var a="";if(!Array.isArray(t))throw new Error(r+"charsToDec: input must be an array of integers");var i=s(t.length,e,n);if(i.end>i.beg){a+=t[i.beg];for(var o=i.beg+1;o<i.end;o+=1)a+=","+t[o]}return a},n.charsToHex=function(t,e,n){var i="";if(!Array.isArray(t))throw new Error(r+"charsToHex: input must be an array of integers");var o=s(t.length,e,n);if(o.end>o.beg){i+="\\x"+a.charToHex(t[o.beg]);for(var h=o.beg+1;h<o.end;h+=1)i+=",\\x"+a.charToHex(t[h])}return i},n.charsToUnicode=function(t,e,n){var i="";if(!Array.isArray(t))throw new Error(r+"charsToUnicode: input must be an array of integers");var o=s(t.length,e,n);if(o.end>o.beg){i+="U+"+a.charToHex(t[o.beg]);for(var h=o.beg+1;h<o.end;h+=1)i+=",U+"+a.charToHex(t[h])}return i},n.charsToJsUnicode=function(t,e,n){var i="";if(!Array.isArray(t))throw new Error(r+"charsToJsUnicode: input must be an array of integers");var o=s(t.length,e,n);if(o.end>o.beg){i+="\\u"+a.charToHex(t[o.beg]);for(var h=o.beg+1;h<o.end;h+=1)i+=",\\u"+a.charToHex(t[h])}return i},n.charsToAscii=function(t,e,n){var i="";if(!Array.isArray(t))throw new Error(r+"charsToAscii: input must be an array of integers");for(var o=s(t.length,e,n),h=o.beg;h<o.end;h+=1){var l=t[h];i+=l>=32&&126>=l?String.fromCharCode(l):"\\x"+a.charToHex(l)}return i},n.charsToAsciiHtml=function(t,e,n){if(!Array.isArray(t))throw new Error(r+"charsToAsciiHtml: input must be an array of integers");for(var o,h="",l=s(t.length,e,n),c=l.beg;c<l.end;c+=1)o=t[c],h+=32>o||127===o?'<span class="'+i.CLASS_CTRL+'">'+a.asciiChars[o]+"</span>":o>127?'<span class="'+i.CLASS_CTRL+'">U+'+a.charToHex(o)+"</span>":a.asciiChars[o];return h},n.stringToAsciiHtml=function(t){var e=this.stringToChars(t);return this.charsToAsciiHtml(e)}},{"./identifiers.js":5}]},{},[1]);
